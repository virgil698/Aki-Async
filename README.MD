# AkiAsync - å¼‚æ­¥ä¼˜åŒ–æ’ä»¶

[![License](https://img.shields.io/github/license/LeavesMC/leaves-plugin-template)](LICENSE)

ä¸€ä¸ªä¸“ä¸º **Leaves 1.21.8** æœåŠ¡ç«¯è®¾è®¡çš„å¼‚æ­¥ä¼˜åŒ–æ’ä»¶ï¼Œé€šè¿‡ Mixin æŠ€æœ¯å¯¹æœåŠ¡ç«¯è¿›è¡Œæ·±åº¦æ€§èƒ½ä¼˜åŒ–ã€‚

## âœ¨ ç‰¹æ€§

### ğŸš€ å·²å®ç°çš„å¼‚æ­¥ä¼˜åŒ–

#### 1. **å¼‚æ­¥å®ä½“è¿½è¸ªå™¨ (Async Entity Tracker)** âœ…
- âœ… å°†å®ä½“ä½ç½®æ›´æ–°è®¡ç®—ç§»è‡³å¼‚æ­¥çº¿ç¨‹
- âœ… å¼‚æ­¥å¤„ç†ç©å®¶è§†è·å†…çš„å®ä½“å¯è§æ€§æ£€æŸ¥
- âœ… ä½ç½®é¢„æµ‹å’Œè¾¹ç¼˜æ£€æµ‹ä¼˜åŒ–
- âœ… å‡å°‘ä¸»çº¿ç¨‹è´Ÿè½½ï¼Œæå‡ TPS ç¨³å®šæ€§
- âœ… æ™ºèƒ½å¤„ç†ï¼šç©å®¶å®ä½“ä¿æŒåŒæ­¥ä»¥ç¡®ä¿å“åº”é€Ÿåº¦

#### 2. **å¼‚æ­¥ç”Ÿç‰©ç”Ÿæˆ (Async Mob Spawning)** âœ…
- âœ… åœ¨ NaturalSpawner è°ƒç”¨ç‚¹é™æµï¼ˆåŒºå—å¯†åº¦é˜ˆå€¼ï¼‰
- âœ… Spawner æ–¹å—ä¼˜åŒ–
- âœ… é¢„è®¡ç®—ä¸ç¼“å­˜ç”Ÿæˆæ¡ä»¶

#### 3. **AI Brain é™é¢‘ (Brain Throttle)** âœ…
- âœ… é™æ­¢å®ä½“åœ¨å¯é…ç½®é—´éš”å†…è·³è¿‡ `Brain#tick`ï¼Œäº‹ä»¶å‘ç”Ÿç«‹å³æ¢å¤
- âœ… å¯¹ä½æ´»è·ƒåº¦å®ä½“é™ä½AIè®¡ç®—é¢‘ç‡

#### 5. **EntityTickList å¹¶è¡Œå¤„ç†** âœ… NEW! (æœ€å¤§çƒ­ç‚¹ä¼˜åŒ–)
- âœ… å°†å®ä½“tickåˆ—è¡¨ï¼ˆå 76%çƒ­ç‚¹ï¼‰åˆ†æ®µå¹¶è¡Œå¤„ç†
- âœ… ForkJoinPool 6çº¿ç¨‹å¹¶è¡Œï¼Œåº”å¯¹1000+å®ä½“åœºæ™¯
- âœ… Leafé£æ ¼é›¶åå°„è®¾è®¡ï¼šåˆå§‹åŒ–ä¸€æ¬¡ï¼Œçƒ­è·¯å¾„è¯»volatile
- âœ… æ™ºèƒ½é˜ˆå€¼ï¼šå°‘äº50å®ä½“ä¸å¯ç”¨ï¼Œé¿å…overhead

#### 6. **å¯»è·¯é¢„ç®—è°ƒåº¦ (Pathfinding Budget)** âœ…
- âœ… ä¸º `PathNavigation#createPath` è®¾ç½®æ¯ tick é¢„ç®—
- âœ… è¶…å‡ºé¢„ç®—çš„è¯·æ±‚åŠ å…¥å»¶è¿Ÿé˜Ÿåˆ—ï¼Œå¹³æ»‘åˆ†æ•£è´Ÿè½½

#### 7. **å¼‚æ­¥å…‰ç…§ä¼˜åŒ– (Async Lighting)** âœ… ENHANCED! (ScalableLux/Starlight)
- âœ… åŒºå—åŠ è½½æ—¶çš„å¼‚æ­¥å…‰ç…§è®¡ç®—
- âœ… å…‰ç…§æ›´æ–°æ‰¹é‡å¤„ç†ï¼ˆå‡å°‘çº¿ç¨‹å¼€é”€ï¼‰
- âœ… å¤©ç©ºå…‰ç¼“å­˜ï¼ˆé¿å…é‡å¤è®¡ç®—ï¼‰
- âœ… **çœŸæ­£çš„åˆ†å±‚ä¼ æ’­é˜Ÿåˆ—**ï¼ˆ16å±‚å…‰ç…§ç­‰çº§ï¼ŒStarlightæ ¸å¿ƒç®—æ³•ï¼‰
- âœ… **æ™ºèƒ½æ‰¹é‡å¤§å°è°ƒæ•´**ï¼ˆæ ¹æ®TPSåŠ¨æ€è°ƒæ•´ï¼Œ8-64èŒƒå›´ï¼‰
- âœ… **å…‰ç…§æ›´æ–°å»é‡**ï¼ˆé˜²æ­¢é‡å¤è®¡ç®—ï¼Œæå‡30%æ•ˆç‡ï¼‰
- âœ… **ä¼ æ’­è·ç¦»é™åˆ¶**ï¼ˆé˜²æ­¢è¿‡æœŸæ›´æ–°ï¼Œ5ç§’è¶…æ—¶æ¸…ç†ï¼‰
- âœ… ä¸“ç”¨å…‰ç…§çº¿ç¨‹æ± ï¼ˆ2çº¿ç¨‹é»˜è®¤ï¼‰

### ğŸ¯ è§„åˆ’ä¸­çš„ä¼˜åŒ–
- â³ åŒºå—ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆéœ€é€‚é…Leaves APIï¼‰
- â³ çº¢çŸ³é«˜çº§ä¼˜åŒ–ï¼ˆAlternate Current + Carpetï¼Œéœ€é€‚é…Leaves APIï¼‰
- â³ VMPé«˜å¹¶å‘ä¼˜åŒ–ï¼ˆéœ€é€‚é…Leaves APIï¼‰
- â³ åŠ¨æ€è¿½è¸ªèŒƒå›´è°ƒæ•´
- â³ ç½‘ç»œå‹ç¼©ä¼˜åŒ–

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- **æœåŠ¡ç«¯**: [Leaves](https://github.com/LeavesMC/Leaves) 1.21.8+
- **JDK**: 21 æˆ–æ›´é«˜ç‰ˆæœ¬
- **å¯åŠ¨å‚æ•°**: å¿…é¡»æ·»åŠ  `-Dleavesclip.enable.mixin=true`

## ğŸ”§ å®‰è£…

1. **ä¸‹è½½æ’ä»¶ JAR æ–‡ä»¶**
   ```bash
   # æˆ–è€…ä» Releases é¡µé¢ä¸‹è½½
   ./gradlew build
   ```

2. **å°†æ’ä»¶æ”¾å…¥æœåŠ¡å™¨çš„ `plugins` æ–‡ä»¶å¤¹**

3. **ä¿®æ”¹å¯åŠ¨è„šæœ¬ï¼Œæ·»åŠ  Mixin æ”¯æŒ**
   ```bash
   java -Dleavesclip.enable.mixin=true -jar leaves.jar
   ```

4. **é‡å¯æœåŠ¡å™¨**

## âš™ï¸ é…ç½®

é…ç½®æ–‡ä»¶ä½äº `plugins/AkiAsync/config.yml`

```yaml
# å®ä½“è¿½è¸ªå™¨
entity-tracker:
  enabled: true
  thread-pool-size: 4
  update-interval-ticks: 1
  max-queue-size: 1000

# ç”Ÿç‰©ç”Ÿæˆ
mob-spawning:
  enabled: true
  spawner-optimization: true

# å¯†åº¦ä¸é¢„ç®—
density:
  max-per-chunk: 80
  ai-cooldown-ticks: 10

pathfinding:
  tick-budget: 128   # 0=ç¦ç”¨é¢„ç®—ï¼Œå»ºè®®åœ¨ 64~256 è¯•éªŒ

# Brain é™é¢‘
brain:
  throttle: true
  throttle-interval: 10

# é«˜æˆæœ¬AIå¼‚æ­¥å¤„ç†ï¼ˆä¸“ç”¨çº¿ç¨‹æ± ï¼‰
expensive-ai:
  enabled: true
  pool-size: 2
  entities:
    - "VILLAGER"
    - "PIGLIN"
    - "WITCH"
    # å¯æ·»åŠ è‡ªå®šä¹‰å®ä½“ç±»å‹

# ç»Ÿä¸€å¼‚æ­¥å¯»è·¯ç³»ç»Ÿï¼ˆæ™®é€šç”Ÿç‰©ï¼‰
async-pathfinding:
  enabled: true
  pool-size: 3
  parallel-collision: true
  collision-threads: 2
  async-move: false
  max-move-tasks: 2048

# æ€§èƒ½ä¸æ—¥å¿—
performance:
  debug-logging: false
  enable-metrics: true
```

## ğŸ› ï¸ å¼€å‘

### æ„å»ºé¡¹ç›®

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/YourUsername/Aki-Async.git
cd Aki-Async

# æ„å»º
./gradlew build

# è¿è¡Œæµ‹è¯•æœåŠ¡å™¨
./gradlew runServer
```

### é¡¹ç›®ç»“æ„

```
Aki-Async/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/org/virgil/akiasync/
â”‚   â”‚   â”‚   â”œâ”€â”€ AkiAsyncPlugin.java
â”‚   â”‚   â”‚   â”œâ”€â”€ config/ConfigManager.java
â”‚   â”‚   â”‚   â””â”€â”€ executor/AsyncExecutorManager.java
â”‚   â”‚   â””â”€â”€ resources/config.yml
â”‚   â””â”€â”€ mixin/
â”‚       â”œâ”€â”€ java/org/virgil/akiasync/
â”‚       â”‚   â”œâ”€â”€ async/AsyncConfig.java
â”‚       â”‚   â”œâ”€â”€ mixin/
â”‚       â”‚   â”‚   â”œâ”€â”€ brain/BrainThrottleMixin.java
â”‚       â”‚   â”‚   â”œâ”€â”€ world/CollisionParallelMixin.java
â”‚       â”‚   â”‚   â”œâ”€â”€ entity/AsyncMoveMixin.java
â”‚       â”‚   â”‚   â”œâ”€â”€ entitytracker/...
â”‚       â”‚   â”‚   â”œâ”€â”€ spawning/...
â”‚       â”‚   â”‚   â””â”€â”€ pathfinding/PathfindingBudgetMixin.java
â”‚       â””â”€â”€ resources/
â”‚           â”œâ”€â”€ aki-async.mixins.json
â”‚           â””â”€â”€ aki-async.accesswidener
â””â”€â”€ build.gradle.kts
```

## ğŸ“š å‚è€ƒé¡¹ç›®

æœ¬é¡¹ç›®çš„å®ç°å‚è€ƒäº†ä»¥ä¸‹ä¼˜ç§€çš„å¼€æºé¡¹ç›®ï¼š

- [Nitori](https://github.com/Gensokyo-Reimagined/Nitori) - å®ä½“è¿½è¸ªå™¨å¼‚æ­¥ä¼˜åŒ–æ€è·¯
- [Leaf](https://github.com/Winds-Studio/Leaf) - æœåŠ¡ç«¯æ€§èƒ½ä¼˜åŒ–è¡¥ä¸
- [Leaves](https://github.com/LeavesMC/Leaves) - æ”¯æŒ Mixin çš„æœåŠ¡ç«¯

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### å¼€å‘æŒ‡å—
1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## âš ï¸ å…è´£å£°æ˜

- æœ¬æ’ä»¶é€šè¿‡ Mixin ä¿®æ”¹æœåŠ¡ç«¯æ ¸å¿ƒä»£ç ï¼Œè¯·åœ¨ä½¿ç”¨å‰å……åˆ†æµ‹è¯•
- å»ºè®®å…ˆåœ¨æµ‹è¯•æœåŠ¡å™¨ä¸ŠéªŒè¯ç¨³å®šæ€§
- å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·ç¦ç”¨æ’ä»¶å¹¶æäº¤ Issue
- ä¸ä¿è¯ä¸æ‰€æœ‰å…¶ä»–æ’ä»¶å…¼å®¹

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®éµå¾ª [MIT License](LICENSE) å¼€æºåè®®ã€‚

## ğŸŒŸ è‡´è°¢

- Leaves å›¢é˜Ÿæä¾›çš„ä¼˜ç§€æœåŠ¡ç«¯å’Œ Mixin æ”¯æŒ
- Fabric å›¢é˜Ÿçš„ Mixin æŠ€æœ¯
- æ‰€æœ‰å‚è€ƒé¡¹ç›®çš„å¼€å‘è€…ä»¬

---

**ä½œè€…**: Virgil  
**é¡¹ç›®åœ°å€**: https://github.com/YourUsername/Aki-Async  
**æ”¯æŒç‰ˆæœ¬**: Leaves 1.21.8+

å¦‚æœè§‰å¾—è¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª â­ Starï¼
