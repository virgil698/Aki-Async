# ==========================================
# AkiAsync 配置文件 / Configuration File
# ==========================================

# 配置版本 / Configuration version (需要更新时会自动提示 / Auto-prompt when update needed)
version: 17

# ==========================================
# 实体系统优化 / Entity System Optimization
# ==========================================
# 异步实体追踪器 / Async Entity Tracker (异步处理实体位置更新 / Async position tracking)
entity-tracker:
  enabled: true  # 启用异步追踪 / Enable async tracking
  thread-pool-size: 4  # 线程池大小，推荐CPU核心数 / Thread pool size, recommended: CPU cores
  update-interval-ticks: 1  # 更新间隔(tick)，1=每tick更新 / Update interval in ticks, 1=every tick
  max-queue-size: 10000  # 最大队列长度，队列满时降级同步 / Max queue size, fallback to sync when full (推荐1000-20000 / Recommended: 1000-20000)

# 异步生物生成 / Async Mob Spawning (异步自然生成逻辑 / Async natural spawning)
mob-spawning:
  enabled: true  # 启用异步生成 / Enable async spawning
  spawner-optimization: true  # 优化刷怪笼性能 / Optimize spawner performance
  spawn-interval: 1  # 生成频率 / Spawn frequency (1=每tick, 2=每2tick, 3=每3tick / 1=every tick, 2=every 2 ticks, 3=every 3 ticks)

# 实体密度控制 / Entity Density Control (限制单区块实体数 / Limit per chunk)
density:
  enabled: true  # 启用密度限制 / Enable density limit
  max-per-chunk: 80  # 单区块最大实体数 / Max entities per chunk

# AI降频 / Brain Throttle (静止实体降低更新频率 / Reduce updates for stationary mobs)
# Note: UniversalAI自动感知降频状态 / UniversalAI auto-respects throttle state
brain:
  enabled: true  # 启用AI降频 / Enable brain throttling
  throttle-interval: 10  # 降频间隔(tick)，静止实体每N tick更新一次 / Throttle interval in ticks, stationary mobs update every N ticks

# 窒息优化 / Suffocation Optimization (仅在实体能受伤时检测窒息 / Only check when entity can take damage)
suffocation-optimization:
  enabled: true  # 启用窒息优化 / Enable suffocation optimization

# 虚拟实体兼容性 / Virtual Entity Compatibility (第三方虚拟/发包实体插件)
# Warning: 禁用后虚拟实体插件可能无法显示 / May break virtual entity plugins when disabled
virtual-entity-compatibility:
  enabled: true
  bypass-packet-queue: true  # 虚拟实体包绕过队列直发 / Bypass queue for virtual entity packets
  exclude-from-throttling: true  # 从节流排除 / Exclude from throttling
  
  plugins:
    fancynpcs:
      enabled: true  # FancyNpcs NPC识别为虚拟实体 / Identify as virtual entities
      use-api: true
      priority: 90
    
    znpcsplus:
      enabled: true  # ZNPCsPlus NPC识别为虚拟实体 / Identify as virtual entities
      use-api: false  # 主要通过名称前缀检测 / Primarily name prefix detection
      priority: 90

# 实体碰撞优化 / Entity Collision Optimization
# 针对密集实体环境的高性能碰撞检测优化
# High-performance collision detection for dense entity scenarios
collision-optimization:
  enabled: true  # 总开关 / Master switch
  
  # 激进模式 / Aggressive Mode
  # 启用后性能提升最大，但极端情况下可能有轻微物理不准确
  # Maximum performance boost, but may have slight physics inaccuracy in extreme cases
  aggressive-mode: true
  
  # 碰撞缓存 / Collision Cache
  cache:
    enabled: true
    lifetime-ms: 50  # 缓存有效期（毫秒） / Cache lifetime in milliseconds
    movement-threshold: 0.01  # 移动阈值，低于此值视为静止 / Movement threshold, below = stationary
  
  # 空间分区 / Spatial Partition
  spatial-partition:
    enabled: true
    grid-size: 4  # 网格大小（方块） / Grid size in blocks (推荐: 2-8 / Recommended: 2-8)
    density-threshold: 50  # 触发阈值（实体数） / Trigger threshold (entity count)
    update-interval-ms: 100  # 网格更新频率（毫秒） / Grid update interval in milliseconds
  
  # 碰撞跳过 / Collision Skip
  skip-checks:
    min-movement: 0.001  # 最小移动阈值 / Minimum movement threshold
    check-interval-ms: 50  # 检测间隔（毫秒） / Check interval in milliseconds
  
  # 实体推挤优化 / Entity Push Optimization
  push-optimization:
    enabled: true
    max-push-per-tick: 0.5  # 单tick最大推力 / Max push force per tick (推荐: 0.3-0.8 / Recommended: 0.3-0.8)
    damping-factor: 0.7  # 推力衰减系数 / Push damping factor (推荐: 0.5-0.9 / Recommended: 0.5-0.9)
    high-density-threshold: 10  # 高密度阈值（实体数） / High density threshold (entity count)
    high-density-multiplier: 0.3  # 高密度区域推力倍数 / Push multiplier in high density (推荐: 0.2-0.5 / Recommended: 0.2-0.5)
  
  # 高级碰撞优化 / Advanced Collision Optimization
  advanced:
    enabled: true  # 启用高级优化 / Enable advanced optimization
    collision-threshold: 8  # 碰撞阈值，超过此数量直接造成窒息伤害而不推挤 / Collision threshold, apply suffocation damage instead of push
    suffocation-damage: 0.5  # 窒息伤害（每秒） / Suffocation damage per second
    max-push-iterations: 8  # 最大推挤迭代次数，防止密集区无限循环 / Max push iterations to prevent infinite loops
    
    # Section 实体网格优化 / Section Entity Grid Optimization
    use-section-grid: true  # 使用 Section 网格（推荐） / Use Section grid (recommended)
    section-grid-warmup: false  # 预热网格（可选，增加内存占用） / Warmup grid (optional, increases memory usage)
  
  # 形状优化 / Shape Optimization
  shape-optimization:
    enabled: true  # 启用形状优化 / Enable shape optimization
    precompute-arrays: true  # 预计算形状数组 / Precompute shape arrays (减少对象分配 / Reduces object allocation)
    block-shape-cache: true  # 方块形状缓存 / Block shape cache (2-3x更快 / 2-3x faster)
    cache-size: 512  # 缓存大小 / Cache size (推荐512-2048 / Recommended: 512-2048)

# 实体移动优化 / Living Entity Travel Optimization
living-entity-travel-optimization:
  enabled: true
  skip-interval: 2  # 每N个tick处理一次移动 / Process movement every N ticks

# 行为触发节流 / Behavior Trigger Throttle
behavior-throttle:
  enabled: false  # 默认禁用，可能影响AI准确性 / Disabled by default, may affect AI accuracy
  throttle-interval: 3  # 每N个tick触发一次 / Trigger every N ticks

# 生物消失检查优化 / Mob Despawn Check Optimization
mob-despawn-optimization:
  enabled: true
  check-interval: 20  # 消失检查间隔（ticks） / Despawn check interval (ticks)

# 并行实体Tick / Parallel Entity Tick
entity-tick-parallel:
  enabled: true
  threads: 6  # 推荐CPU核心数×1.5 / Recommended: CPU cores × 1.5
  min-entities: 50  # 低于此值不启用并行 / Skip parallel below threshold
  batch-size: 8  # 8个实体一批 / 8 entities per batch

# 实体节流 / Entity Throttling
entity-throttling:
  enabled: false  # 默认禁用，谨慎启用 / Disabled by default, enable with caution
  config-file: "throttling.yml" # 如果开启请根据需求进行调整节流列表 / If enabled, adjust throttling list as needed
  check-interval: 100  # 每N tick检查一次 / Check every N ticks
  throttle-interval: 3  # 超限后每N tick更新 / Update every N ticks when exceeded
  removal-batch-size: 10  # 每次最多移除N个 / Remove at most N per check

# ==========================================
# 零延迟异步AI / Zero-Latency Async AI
# ==========================================
async-ai:
  timeout-microseconds: 100  # 全局超时 / Global timeout (100μs = 0.1ms)
  
  # 村民优化 / Villager Optimization (支持Villager, Wandering Trader / POI快照+职业原子占坑)
  villager-optimization:
    enabled: false
    use-poi-snapshot: true  # 村民需要POI系统(床/工作站) / Needs POI (beds/job sites)
    
    # 快速射线追踪 / Fast Raytrace (优化村民视线检测 / Optimize villager line-of-sight)
    fast-raytrace:
      enabled: true  # 启用后村民AI性能提升15-20% / 15-20% villager AI boost when enabled
      cache-size: 256  # 缓存大小 / Cache size
    
    # POI查询缓存 / POI Query Cache (缓存村民POI查询结果 / Cache villager POI queries)
    poi-cache:
      enabled: true
      cache-expire-time: 100  # 缓存过期时间（毫秒） / Cache expiration time (ms)
    
    # 繁殖优化 / Breed Optimization (异步繁殖逻辑 / Async breeding logic)
    breed-optimization:
      async-villager-breed: true  # 异步处理村民繁殖 / Async villager breeding
      threads: 4  # 繁殖线程数 / Breeding threads
      age-throttle: true  # 跳过空闲村民20 ticks / Skip idle villagers for 20 ticks
      check-interval: 5  # 检查间隔 / Check interval
  
  # 猪灵家族优化 / Piglin Family Optimization (支持Piglin, PiglinBrute / UUID虚拟引用+物品比价+恐惧向量)
  piglin-optimization:
    enabled: false  # 启用猪灵AI优化 / Enable piglin AI optimization
    use-poi-snapshot: false  # 使用POI快照避免主线程查询 / Use POI snapshot to avoid main thread queries
    look-distance: 16  # 猪灵寻找目标的最大距离 / Maximum distance for piglin to look for targets
    barter-distance: 16  # 猪灵物品交易的最大距离 / Maximum distance for piglin bartering
  
  # 掠夺者家族优化 / Pillager Family Optimization (支持Pillager, Vindicator, Ravager / 安全反射+Raid检测)
  pillager-family-optimization:
    enabled: false  # 启用掠夺者AI优化 / Enable pillager AI optimization
    use-poi-snapshot: false  # 使用POI快照避免主线程查询 / Use POI snapshot to avoid main thread queries
  
  # 唤魔者优化 / Evoker Optimization (法术CD+召唤Vex+空地块检测)
  evoker-optimization:
    enabled: false
  
  # 烈焰人优化 / Blaze Optimization (火焰弹CD+火柱空位检测)
  blaze-optimization:
    enabled: false
  
  # 守卫者优化 / Guardian Optimization (激光CD+水下玩家扫描)
  guardian-optimization:
    enabled: false
  
  # 女巫优化 / Witch Optimization (最近玩家目标筛选+安全异常处理)
  witch-optimization:
    enabled: false
  
  # 异步寻路 / Async Pathfinding
  async-pathfinding:
    enabled: true  # 启用异步寻路 / Enable async pathfinding
    max-threads: 8  # 线程池大小 / Thread pool size (推荐CPU核心数×1.5 / Recommended: CPU cores × 1.5)
    keep-alive-seconds: 60  # 线程存活时间 / Thread keep-alive time
    max-queue-size: 500  # 最大队列大小 / Max queue size (推荐500-1000 / Recommended: 500-1000)
    
    # 路径缓存 / Path Cache (路径重用优化 / Path reuse optimization)
    cache:
      enabled: true  # 启用缓存 / Enable cache
      max-size: 1000  # 最大缓存路径数 / Max cached paths (推荐1000-2000 / Recommended: 1000-2000)
      expire-seconds: 30  # 路径过期时间 / Path expiration time (推荐20-60秒 / Recommended: 20-60s)
      reuse-tolerance: 3  # 路径重用容差（方块） / Path reuse tolerance in blocks
      cleanup-interval-seconds: 5  # 清理间隔 / Cleanup interval

  # 统一AI优化 / Universal AI (所有剩余生物见entities.yml / 统一模板+配置化+DAB)
  universal-ai-optimization:
    enabled: true
    entities-config-file: "entities.yml"
    # 动态激活大脑 / Dynamic Activation of Brain (Pufferfish技术: 距离越远tick越慢)
    dynamic-activation:
      enabled: true
      start-distance: 12  # 此距离内全速tick / Full speed within this distance
      activation-dist-mod: 8  # 减速梯度，值越大越慢 / Slowdown gradient
      max-tick-interval: 20  # 最远实体的最大间隔 / Max interval for farthest

# ==========================================
# VMP优化套件 / VMP Optimizations
# ==========================================
vmp-optimizations:
  # 区块加载优化 - 限制每玩家并发加载数，防止大量玩家同时传送导致卡顿
  # Chunk loading optimization - Limits concurrent loads per player to prevent lag from mass teleports
  chunk-loading:
    enabled: true
    max-concurrent-per-player: 5  # 每玩家最大并发区块加载，降低可减少卡顿但加载更慢 / Max concurrent chunk loads per player, lower = less lag but slower loading
  
  # 实体追踪优化 - 减少实体追踪范围以降低网络和CPU开销
  # Entity tracking optimization - Reduces tracking range to lower network and CPU overhead
  entity-tracking:
    enabled: true
    range-multiplier: 0.8  # 实体追踪范围倍数(0.8=原版80%)，降低可提升性能但玩家看到实体更晚 / Entity tracking range multiplier (0.8=80% of vanilla), lower = better performance but entities appear later

# ==========================================
# 红石优化套件 / Redstone Optimizations
# ==========================================
redstone-optimizations:
  alternate-current:
    enabled: true  # Alternate Current算法 / AC algorithm
  
  wire-turbo:
    enabled: true  # 红石线加速 / Redstone wire turbo
  
  # PandaWire算法 / PandaWire Algorithm (Sakura project)
  pandawire:
    enabled: false  # 默认关闭 / Disabled by default
  
  update-batching:
    enabled: true  # 更新批处理 / Update batching
    batch-threshold: 50  # 批处理阈值，PandaWire使用此值 / Batch threshold, used by PandaWire
  
  cache:
    enabled: true  # 红石缓存 / Redstone cache
    duration-ms: 50  # 缓存持续时间ms / Cache duration
  
  # 红石网络缓存 / Redstone Network Cache
  # Caches redstone wire network patterns for repeated updates
  network-cache:
    enabled: true  # 启用网络缓存 / Enable network caching
    expire-ticks: 600  # 缓存过期时间(tick) / Cache expiry in ticks (600 = 30 seconds)

# ==========================================
# 掉落物优化 / Item Entity Optimizations
# ==========================================
item-entity-optimizations:
  # 并行处理 / Parallel (刷怪塔40-60%/农场30-50%/爆炸50-70% / Mob farms/Auto farms/Explosions)
  parallel-processing:
    enabled: true
    min-item-entities: 50  # 推荐50-100 / Recommended: 50-100
    batch-size: 20  # 推荐20-40 / Recommended: 20-40
  
  # 智能合并 / Smart Merge (减少60-80%检查/降低2-4ms MSPT / 60-80% less checks/2-4ms MSPT)
  smart-merge:
    enabled: true
    merge-interval: 5  # 推荐5-10 / Recommended: 5-10
    min-nearby-items: 3  # 推荐3-5 / Recommended: 3-5
    merge-range: 1.5  # 推荐1.5-2.5 / Recommended: 1.5-2.5
  
  # 年龄优化 / Age (静止物品降低80-90% tick/降低3-5ms MSPT / 80-90% less ticks/3-5ms MSPT)
  age-optimization:
    enabled: true
    age-interval: 10  # 推荐10-20 / Recommended: 10-20
    player-detection-range: 8.0  # 推荐8.0-16.0 / Recommended: 8.0-16.0

# ==========================================
# 方块实体优化 / Block Entity Optimizations
# ==========================================
block-entity-optimizations:
  # 零延迟工厂优化 / Zero-Delay Factory (Furnace/Hopper/Chest/Barrel见entities.yml)
  zero-delay-factory-optimization:
    enabled: true  # 启用后方块实体tick延迟降至0 / Reduces block entity tick delay to 0
    entities-config-file: "entities.yml"  # 与universal-ai共用 / Shared with universal-ai
  
  # 并行tick / Parallel Tick (C3H6N6O6设计 / Folia下自动禁用)
  parallel-tick:
    enabled: true  # 多线程并行处理方块实体tick / Multi-threaded block entity ticking
    min-block-entities: 50  # 低于此值不并行 / Skip parallel below threshold
    batch-size: 16  # 每批次处理的方块实体数 / Block entities per batch
    protect-containers: true  # 容器主线程执行防物品丢失 / Containers on main thread to prevent item loss
    timeout-ms: 50  # 超时降级同步 / Fallback to sync on timeout
  
  # 漏斗容器缓存 / Hopper Container Cache (缓存容器查询结果 / Cache container queries)
  hopper-optimization:
    enabled: true
    cache-expire-time: 100  # 缓存过期时间（毫秒） / Cache expiration time (ms)
    container-cache: true  # 容器缓存 / Container cache
    skip-failed-transfers: true  # 跳过失败的传输尝试 / Skip failed transfer attempts
    fast-empty-full-check: true  # 快速空满检测 / Fast empty/full check
  
  # 流体流动优化 / Fluid Flow Optimization (基于 Lithium / Based on Lithium)
  fluid-flow-optimization:
    enabled: true  # 启用流体优化 / Enable fluid optimization
    optimize-sign-check: true  # 优化告示牌检查 / Optimize sign check (避免标签查找 / Avoid tag lookup)
    reduce-state-queries: true  # 减少方块状态查询 / Reduce block state queries
  
  # 矿车tick优化 / Minecart Tick Optimization (降低矿车tick频率 / Reduce minecart tick frequency)
  minecart-optimization:
    enabled: true
    tick-interval: 2  # 矿车tick间隔 / Minecart tick interval

recipe-optimization:
  # FastFurnace熔炉配方缓存 / FastFurnace (自定义配方多时提升明显 / Significant boost with custom recipes)
  furnace-recipe-cache:
    enabled: true  # 缓存熔炉配方避免重复查找 / Cache furnace recipes to avoid repeated lookups
    cache-size: 100  # 每个熔炉缓存数 / Cached recipes per furnace
    apply-to-blast-furnace: true  # 应用于高炉 / Apply to blast furnaces
    apply-to-smoker: true  # 应用于烟熏炉 / Apply to smokers
    fix-burn-time-bug: true  # 修复>32767燃烧时间bug / Fix >32767 burn time bug
  
  # FastWorkbench工作台缓存 / FastWorkbench (实验性 / Experimental)
  # Warning: 实验性功能，可能不兼容某些插件 / May be incompatible with some plugins
  crafting-recipe-cache:
    enabled: false  # 默认关闭，可能与某些插件冲突 / Disabled by default, may conflict with plugins
    cache-size: 200  # 工作台配方缓存大小 / Crafting recipe cache size
    optimize-batch-crafting: true  # Shift+点击优化O(i×s)→1 / Shift+click O(i×s)→1
    reduce-network-traffic: true  # 减少配方同步网络流量 / Reduce recipe sync network traffic

misc-optimizations:
  # 矿车炼药锅销毁 / Minecart Cauldron (支持漏斗/箱子矿车 / Hopper/Chest minecarts)
  minecart-cauldron-destruction:
    enabled: true

# TNT爆炸优化 / TNT Explosion Optimization (异步计算 / Async calculation)
tnt-explosion-optimization:
  enabled: true
  entities:  # 白名单实体 / Whitelisted entities
    - "minecraft:tnt"
    - "minecraft:tnt_minecart"
    - "minecraft:wither_skull"
  threads: 6  # 推荐CPU核心数×1.5 / Recommended: CPU cores × 1.5
  
  # 原版兼容性 / Vanilla Compatibility
  vanilla-compatibility:
    enabled: true  # 启用原版兼容模式 / Enable vanilla compatibility mode
    use-vanilla-power: true  # 使用原版爆炸威力 / Use vanilla explosion power
    use-vanilla-fire-logic: true  # 使用原版火焰逻辑 / Use vanilla fire logic
    use-vanilla-damage-calculation: true  # 使用原版伤害计算 / Use vanilla damage calculation (重要：确保对生物造成伤害 / IMPORTANT: Ensures damage to entities)
    use-full-raycast: false  # 使用完整射线追踪 / Use full raycast (更精确但性能开销大 / More accurate but higher performance cost)
    use-vanilla-block-destruction: true  # 使用原版方块破坏 / Use vanilla block destruction
    use-vanilla-drops: true  # 使用原版掉落物 / Use vanilla drops
  
  # 爆炸缓存优化 / Explosion Cache Optimization
  cache:
    enabled: true  # 启用缓存 / Enable caching
    use-optimized-cache: true  # 使用优化缓存（long key） / Use optimized cache (long key)
    cache-expiry-ticks: 600  # 缓存过期时间(tick) / Cache expiry in ticks (600 = 30 seconds)
    warmup-enabled: false  # 预热缓存（可选） / Warmup cache (optional)
  
  # 爆炸密度缓存 / Explosion Density Cache (Sakura)
  # Advanced density caching for explosion calculations
  density-cache:
    enabled: true  # 启用密度缓存 / Enable density caching
    use-lenient-cache: true  # 使用宽松缓存提高命中率 / Use lenient cache for better hit rate
  
  # 预计算爆炸形状 / Precomputed Explosion Shape
  precomputed-shape:
    enabled: true  # 启用预计算形状 / Enable precomputed shape
    use-occlusion-detection: true  # 使用三点共线遮挡检测 / Use 3-point collinear occlusion detection
    occlusion-threshold: 0.5  # 遮挡阈值（方块） / Occlusion threshold (blocks)
  
  # 批量碰撞检测优化 / Batch Collision Detection
  batch-collision:
    enabled: true  # 启用批量碰撞检测 / Enable batch collision detection
    unroll-factor: 4  # 循环展开因子 / Loop unroll factor (2/4/8)
  
  # TNT实体合并 / TNT Entity Merging (Cannon server optimization)
  # Based on Sakura project's TntExplosion system
  entity-merge:
    enabled: false  # 默认关闭 / Disabled by default
    radius: 1.5  # 合并半径(方块) / Merge radius in blocks
    max-fuse-difference: 5  # 最大引信时间差(tick) / Max fuse time difference in ticks
    power-multiplier: 0.5  # 威力增益系数 / Power gain multiplier per merged TNT
    max-power: 12.0  # 最大爆炸威力 / Maximum explosion power
  
  # 领地保护集成 / Land Protection (支持Residence/Dominion/WorldGuard/Lands)
  land-protection:
    enabled: true  # 需要安装对应插件 / Requires protection plugin installed
  
  # BlockLocker容器保护 / BlockLocker Container Protection
  blocklocker-protection:
    enabled: true  # 保护被BlockLocker锁定的容器 / Protect containers locked by BlockLocker

# 下落方块并行处理 / Falling Block Parallel
falling-block-optimization:
  enabled: true
  min-falling-blocks: 20  # 推荐20-50 / Recommendand dupers, gravity blocks and massive falling block scenarios
  # 优化效果 / Performance gain:ed: 20-50
  batch-size: 10  # 推荐10-20 / Recommended: 10-20

# ==========================================
# 光照优化套件 / Lighting Optimizations
# ==========================================
lighting-optimizations:
  # 异步光照计算 / Async Lighting Calculation
  async-lighting:
    enabled: true
    
    # 线程池配置 / Thread Pool Configuration
    # auto模式根据CPU核心数自动调整，manual模式使用固定线程数
    # auto mode adjusts based on CPU cores, manual mode uses fixed thread count
    thread-pool-mode: auto  # auto=自动 / manual=手动
    thread-pool-size-manual: 2  # 手动模式下的线程数 / Threads in manual mode (推荐2-4 / Recommended: 2-4)
    thread-pool-calculation: "cores/3"  # 计算公式 / Calculation formula (cores/3=ScalableLux, cores/2=激进 / aggressive, cores/4=保守 / conservative)
    min-threads: 1  # 最小线程数 / Minimum threads
    max-threads: 8  # 最大线程数 / Maximum threads (防止过度并行 / Prevent over-parallelization)
    
    # 批量处理 / Batch Processing
    batch-threshold: 16  # 基础批量阈值 / Base batch threshold (越大延迟越低但吞吐量越高 / Higher = lower latency but better throughput)
    batch-threshold-max: 64  # 最大批量阈值 / Max batch threshold
    aggressive-batching: false  # 激进批量模式（高端服务器推荐） / Aggressive mode (recommended for high-end servers)
    
    # 优先级调度 / Priority Scheduling (ScalableLux核心特性 / ScalableLux core feature)
    # 根据玩家距离和场景重要性调度光照更新，降低玩家感知延迟50-70%
    # Schedule light updates by player distance and importance, reduce perceived latency by 50-70%
    priority-scheduling:
      enabled: true  # 启用优先级调度 / Enable priority scheduling
      player-radius-high-priority: 32  # 玩家32格内高优先级 / High priority within 32 blocks
      player-radius-medium-priority: 64  # 玩家64格内中优先级 / Medium priority within 64 blocks
      player-radius-low-priority: 128  # 玩家128格内低优先级 / Low priority within 128 blocks
      chunk-loading-priority: high  # 区块加载优先级 / Chunk loading priority (high/medium/normal)
      max-low-priority-delay-ms: 500  # 低优先级最大延迟 / Max delay for low priority updates
    
    # 光照更新去抖动 / Light Debouncing (防止红石等频繁更新 / Prevent frequent updates from redstone)
    # 延迟处理频繁变化的光照，减少无效计算
    # Delay processing frequently changing lights to reduce wasted calculations
    # 注意：地形生成时建议禁用以提高速度 / Note: Disable for faster terrain generation
    debouncing:
      enabled: true  # 启用去抖动 / Enable debouncing (禁用以加快地形生成 / Disabled for faster terrain)
      debounce-delay-ms: 50  # 去抖动延迟 / Debounce delay (推荐30-100ms / Recommended: 30-100ms)
      max-updates-per-second: 20  # 单位置每秒最大更新次数 / Max updates per position per second
      reset-on-stable-ms: 200  # 稳定后重置计数 / Reset counter when stable for this duration
    
    # 光照更新合并 / Light Update Merging (合并相邻更新减少计算 / Merge adjacent updates)
    # 检测并合并相邻方块的光照更新请求
    # Detect and merge light update requests for adjacent blocks
    # 注意：地形生成时建议禁用以提高速度 / Note: Disable for faster terrain generation
    update-merging:
      enabled: true  # 启用更新合并 / Enable update merging (禁用以加快地形生成 / Disabled for faster terrain)
      merge-radius: 2  # 合并半径（方块） / Merge radius in blocks (推荐1-3 / Recommended: 1-3)
      merge-delay-ms: 10  # 合并延迟（毫秒） / Merge delay in ms (等待更多更新 / Wait for more updates)
      max-merged-updates: 64  # 单次最大合并数 / Max merged updates per batch
    
    # 区块边界优化 / Chunk Border Optimization (批量处理跨区块光照 / Batch cross-chunk lighting)
    # 优化跨区块边界的光照传播，减少区块锁竞争
    # Optimize light propagation across chunk borders, reduce chunk lock contention
    chunk-border:
      enabled: true  # 启用边界优化 / Enable border optimization
      batch-border-updates: true  # 批量处理边界更新 / Batch border updates
      border-update-delay-ms: 20  # 边界更新延迟 / Border update delay
      cross-chunk-batch-size: 32  # 跨区块批量大小 / Cross-chunk batch size
    
    # 自适应调整 / Adaptive Tuning (根据负载动态调整参数 / Dynamic parameter adjustment)
    # 监控队列和延迟，自动调整线程数和批量大小
    # Monitor queue and latency, auto-adjust thread count and batch size
    adaptive:
      enabled: true  # 启用自适应 / Enable adaptive tuning
      monitor-interval-seconds: 10  # 监控间隔 / Monitor interval
      auto-adjust-threads: true  # 自动调整线程数 / Auto-adjust thread count
      auto-adjust-batch-size: true  # 自动调整批量大小 / Auto-adjust batch size
      target-queue-size: 100  # 目标队列长度 / Target queue size
      target-latency-ms: 50  # 目标延迟 / Target latency
    
    # 区块卸载优化 / Chunk Unload Optimization (异步清理光照缓存 / Async cleanup)
    # 异步清理卸载区块的光照数据，减少主线程阻塞
    # Async cleanup of lighting data for unloaded chunks, reduce main thread blocking
    chunk-unload:
      enabled: true  # 启用卸载优化 / Enable unload optimization
      async-cleanup: true  # 异步清理 / Async cleanup
      cleanup-batch-size: 16  # 清理批量大小 / Cleanup batch size
      cleanup-delay-ms: 100  # 清理延迟 / Cleanup delay
  
  # 光照传播队列 / Light Propagation Queue
  propagation-queue:
    use-layered-queue: true  # Starlight核心: 16层队列按光照等级0-15分层处理 / 16-layer queue by light level 0-15
    max-propagation-distance: 15  # 最大传播距离，默认15格 / Max propagation distance in blocks
  
  # 天空光缓存 / Skylight Cache
  skylight-cache:
    enabled: true  # 缓存天空光计算结果，减少重复计算 / Cache skylight results to reduce recalculation
    cache-duration-ms: 100  # 缓存有效期(毫秒)，过期后重新计算 / Cache validity in ms
  
  # 高级选项 / Advanced Options
  advanced:
    enable-deduplication: true  # 防止同位置重复排队，避免浪费计算 / Prevent duplicate queuing at same position
    dynamic-batch-adjustment: true  # 根据TPS自动调整批量大小 / Auto-adjust batch size by TPS
    log-advanced-stats: false  # 记录详细统计信息(调试用) / Log detailed stats (for debugging)

# ==========================================
# 区块优化 / Chunk Optimization
# ==========================================
# Folia环境下自动禁用 / Auto-disabled on Folia
chunk-tick-async:
  enabled: false  # 方块Tick异步化 / Block tick async
  threads: 4  # 线程数 / Thread count
  timeout-us: 200  # 超时(微秒) / Timeout in microseconds
  batch-size: 16  # 批量大小 / Batch size

# 区块生成优化 / Chunk Generation Optimization
chunk-generation:
  # 噪声采样优化 / Noise Optimization
  noise-optimization:
    enabled: true  # 启用噪声优化 / Enable noise optimization
  
  # Jigsaw 结构生成优化 / Jigsaw Structure Optimization
  jigsaw-optimization:
    enabled: true  # 启用 Jigsaw 优化 / Enable Jigsaw optimization

# ==========================================
# 结构查找异步化 / Structure Location Async
# ==========================================
# 结构定位异步优化 / Structure Location Async Optimization
# 异步处理结构查找操作，避免主线程阻塞 / Async structure finding to prevent main thread blocking
structure-location-async:
  enabled: true
  threads: 3  # 推荐2-4，根据CPU核心数调整 / Recommended: 2-4, adjust based on CPU cores
  
  # /locate 命令优化 / /locate command optimization
  locate-command:
    enabled: true
    search-radius: 100  # 搜索半径（区块） / Search radius in chunks
    skip-known-structures: false  # 跳过已知结构以加速搜索 / Skip known structures to speed up search
  
  # 村民交易地图优化 / Villager trade map optimization
  villager-trade-maps:
    enabled: true
    search-radius: 100  # 搜索半径（区块） / Search radius in chunks
    skip-known-structures: false  # 跳过已知结构 / Skip known structures
    trade-types:  # 支持的地图类型 / Supported map types
      - "minecraft:ocean_monument_map"
      - "minecraft:woodland_mansion_map"
      - "minecraft:buried_treasure_map"
    generation-timeout-seconds: 30  # 生成超时时间 / Generation timeout in seconds
  
  # 海豚寻宝优化 / Dolphin treasure hunt optimization
  dolphin-treasure-hunt:
    enabled: true
    search-radius: 50  # 搜索半径（方块） / Search radius in blocks
  
  # 箱子探险地图生成 / Chest exploration map generation
  chest-exploration-maps:
    enabled: true
    loot-tables:  # 包含地图的战利品表 / Loot tables containing maps
      - "minecraft:chests/shipwreck_map"
      - "minecraft:chests/underwater_ruin_big"
      - "minecraft:chests/underwater_ruin_small"
  
  # 算法优化 / Algorithm optimization
  algorithm-optimization:
    enabled: true
    search-pattern: "hybrid"  # 搜索模式：spiral(螺旋)/layered(分层)/hybrid(混合) / Search pattern: spiral/layered/hybrid
    caching:
      enabled: true
      max-size: 1000  # 缓存最大条目数 / Maximum cache entries
      expiration-minutes: 30  # 缓存过期时间（分钟） / Cache expiration in minutes
    biome-aware-search:
      enabled: true  # 基于生物群系智能搜索 / Biome-aware intelligent search

# ==========================================
# 高级特性与实验性优化 / Advanced Features & Experimental Optimizations
# ==========================================
# 蜜蜂修复 / Bee Fix (修复7个MC bug / Fixes 7 MC bugs)
# MC-168329/190042/206401/229321/234364/248332/255743
bee-fix:
  enabled: true

# MC-159283 修复 / MC-159283 Fix (修复 End 维度地形环形缺失 / Fix End terrain ring gaps)
# 参考 / Reference: https://bugs.mojang.com/browse/MC-159283
end-island-density-fix:
  enabled: true  # 启用修复 / Enable fix (推荐开启，即使 Leaves 已修复 / Recommended even if Leaves has fix)

# 数据包加载优化 / DataPack Loading Optimization
datapack-optimization:
  enabled: true
  file-load-threads: 4  # 推荐4-8根据CPU / Recommended: 4-8 by CPU
  zip-process-threads: 2  # I/O密集推荐2-4 / I/O intensive, 2-4 recommended
  batch-size: 100  # 影响内存和性能 / Affects memory and performance
  cache-expiration-minutes: 30  # 缓存过期时间（分钟） / Cache expiration time (minutes)
  max-file-cache-size: 1000  # 文件缓存上限，防止内存泄漏 / Max file cache size, prevent memory leak
  max-filesystem-cache-size: 50  # 文件系统缓存上限 / Max filesystem cache size

# 高级并发优化 / Advanced Concurrency Optimizations
nitori:
  enabled: true  # 总开关 / Master switch
  virtual-threads: true  # Java 21+ Virtual Thread / Auto-fallback on older Java
  work-stealing: true  # 工作窃取提升多核利用 / Work-stealing for multi-core
  blockpos-cache: true  # 预计算减少开销 / Pre-compute to reduce overhead
  optimized-collections: true  # 高性能集合类 / High-performance collections

# 数学优化 / Math Optimization
# 优化三角函数计算性能 / Optimize trigonometric function performance
math-optimization:
  enabled: true  # 启用数学优化 / Enable math optimization
  compact-sine-lut: true  # 紧凑型正弦查找表 / Compact sine lookup table (节省75%内存 / Saves 75% memory)

# 安全种子保护 / Secure Seed Protection
# ⚠️ 重要 / IMPORTANT: 启用后不可关闭 / DO NOT disable after enabling
# 关闭会导致: 区块错乱/结构消失/矿石改变/史莱姆区块变化
# Disabling causes: Chunk mismatch/Structure loss/Ore changes/Slime chunk changes
# 如需关闭必须删除世界 / Must delete world to disable
seed-encryption:
  enabled: false  # 启用种子加密 / Enable seed encryption
  
  # 加密方案 / Encryption Scheme
  # - "legacy": 传统方案，性能更好 / Traditional, better performance
  # - "quantum": 推荐方案，安全性更强 / Recommended, stronger security
  scheme: "quantum"  # legacy / quantum
  
  # 保护范围 / Protection Scope
  protect-structures: true  # 村庄/要塞/遗迹 / Villages/Strongholds/Monuments
  protect-ores: true  # 钻石/金矿等 / Diamonds/Gold etc.
  protect-slimes: true  # 史莱姆区块 / Slime chunks
  
  # Legacy方案配置 / Legacy Scheme Config (仅当scheme=legacy时生效)
  legacy:
    seed-bits: 1024  # 1024/2048/4096, 推荐1024平衡性能 / Recommended 1024 for balance
  
  # Quantum方案配置 / Quantum Scheme Config (仅当scheme=quantum时生效)
  quantum:
    encryption-level: 2  # 加密强度 / Level (1=基础/2=标准推荐/3=最强)
    private-key-file: "quantum-seed.key"  # 服务器私钥 / Server Key (自动生成，请备份！/ Auto-gen, backup it!)
    enable-time-decay: false  # 时间衰减 / Time Decay (防时间攻击，可能影响重生成 / Anti-time-attack, may affect regen)
    cache-size: 10000  # 缓存大小 / Cache size (推荐5000-20000 / Recommended: 5000-20000)
  
  # /seed 命令权限控制 / /seed Command Permission Control
  restrict-seed-command: true  # 限制/seed命令仅OP可用 / Restrict /seed to OPs only (权限等级4 / Permission level 4)
  seed-command-deny-message: "&c你没有权限使用此命令。只有服务器管理员可以查看世界种子。"  # 拒绝消息 / Deny message
  
  # 防插件窃取种子 / Anti-Plugin Seed Theft
  anti-plugin-theft:
    enabled: true  # 启用防护 / Enable protection
    return-fake-seed: true  # 返回假种子 / Return fake seed to suspicious callers
    fake-seed-value: 0  # 假种子值 / Fake seed value (0 = random, or specify a number)
    log-suspicious-access: true  # 记录可疑访问 / Log suspicious seed access attempts

# ==========================================
# 网络优化 / Network Optimization
# ==========================================
# 实体包节流优化 / Entity Packet Throttle (高密度实体场景优化 / High-density entity optimization)
entity-packet-throttle:
  enabled: true  # 启用实体包节流 / Enable entity packet throttling
  
  # 距离分级更新 / Distance-Based Update Rate (远距离实体降低更新频率 / Reduce update rate for distant entities)
  distance-based:
    enabled: true  # 启用距离分级 / Enable distance tiers
    tier-1-distance: 16    # 0-16格: 每tick更新 (100%) / 0-16 blocks: every tick (100%)
    tier-2-distance: 32    # 16-32格: 每2tick更新 (50%) / 16-32 blocks: every 2 ticks (50%)
    tier-3-distance: 64    # 32-64格: 每4tick更新 (25%) / 32-64 blocks: every 4 ticks (25%)
    tier-4-distance: 128   # 64-128格: 每8tick更新 (12.5%) / 64-128 blocks: every 8 ticks (12.5%)
    tier-5-distance: 256   # 128+格: 每16tick更新 (6.25%) / 128+ blocks: every 16 ticks (6.25%)
  
  # 视锥体裁剪 / Frustum Culling (视野外实体进一步降频 / Further reduce rate for out-of-view entities)
  frustum-culling:
    enabled: false  # 启用视锥体裁剪 (实验性) / Enable frustum culling (experimental)
    fov-angle: 90  # 视野角度 / Field of view angle
    outside-multiplier: 2  # 视野外降频倍数 / Outside FOV throttle multiplier
  
  # 实体数据节流 / Entity Data Throttle (Metadata & NBT 智能节流 / Smart throttling for Metadata & NBT)
  data-throttle:
    enabled: true  # 启用数据节流 / Enable data throttling

# 区块可见性过滤 / Chunk Visibility Filter (遮挡剔除 / Occlusion Culling)
# 只发送玩家视野内的表层区块，被遮挡的内层区块不发送
# Only send surface chunks in player's view, skip occluded inner chunks
chunk-visibility-filter:
  enabled: true  # 启用区块可见性过滤 / Enable chunk visibility filtering

# 高速移动区块预加载 / Fast Movement Chunk Loading (鞘翅/疾跑/创造飞行)
fast-movement-chunk-load:
  enabled: true
  speed-threshold: 0.5  # 触发速度b/t / Trigger speed (0.5≈10b/s, 推荐0.5/0.3/0.8)
  # 动态调整 / Dynamic: 普通<1.0→8区块, 高速1.0-1.5→10区块, 超高速>1.5→12区块
  preload-distance: 8  # 基础距离 / Base distance (8/6/10: 默认/保守/激进)
  # 动态调整 / Dynamic: 普通→4并发, 高速→8并发, 超高速→12并发
  max-concurrent-loads: 4  # 基础并发 / Base concurrent (4/2/6)
  # 动态调整 / Dynamic: 普通→40ticks, 高速→48ticks, 超高速→60ticks
  prediction-ticks: 40  # 基础预测 / Base prediction (40/30/50)
  
  # 智能偏移加载中心 / Smart Center Offset (根据速度方向偏移实现类远视距 / Offset by speed/direction)
  center-offset:
    enabled: true
    min-speed: 3.0  # 最小触发速度b/t / Min trigger (3.0/2.0/4.0: 默认/敏感/保守)
    max-speed: 9.0  # 最大触发速度b/t / Max trigger (9.0/7.0/12.0, Warning: 过高可能卸载玩家)
    max-offset-ratio: 0.75  # 最大偏移比例 / Max ratio (0.75/0.5/0.9, 公式: 视距×比例×速度比)
  
  # 异步加载批量控制 / Async Batch Control (防止MSPT飙升 / Prevent MSPT spikes)
  async-loading:
    batch-size: 2  # 每批区块数 / Chunks per batch (2/3/4: 保守/平衡/激进)
    batch-delay-ms: 20  # 批次延迟ms / Batch delay (20/15/10)
  
  # 地图渲染加速 / Map Rendering (高速移动时优化地图渲染 / Optimize map rendering during fast movement)
  map-rendering:
    enabled: false  # 实验性功能 / Experimental feature
    threads: 2  # 渲染线程数 / Rendering threads

# ==========================================
# 性能监控与调试 / Performance Monitoring & Debug
# ==========================================
performance:
  # Debug 日志配置 / Debug Logging Configuration
  debug-logging:
    enabled: false  # 启用 debug 日志 / Enable debug logging (仅用于调试 / For debugging only)
    modules:
      tnt: false  # TNT 爆炸 debug / TNT explosion debug
      collision: false  # 碰撞检测 debug / Collision detection debug
      lighting: false  # 光照计算 debug / Lighting calculation debug
      pathfinding: false  # 寻路 debug / Pathfinding debug
      entity: false  # 实体系统 debug / Entity system debug
      chunk: false  # 区块系统 debug / Chunk system debug
      hopper: false  # 漏斗系统 debug / Hopper system debug
      fluid: false  # 流体系统 debug / Fluid system debug
      math: false  # 数学优化 debug / Math optimization debug
      shapes: false  # 形状优化 debug / Shape optimization debug
  
  # 性能指标收集 / Performance Metrics
  enable-metrics: true  # 性能指标收集 / Metrics (显示异步任务时间和队列 / Show async times and queues)

# ==========================================
# 指令配置 / Command Configuration
# ==========================================
commands:
  reload:  # /aki-reload指令 / /aki-reload command
    require-confirmation: true  # 二次确认 / Confirmation (首次警告需再次执行 / Warning on first, execute twice)
    confirmation-timeout: 30  # 确认超时秒 / Timeout seconds

# 提示 / Tip: 更多线程≠更好性能！从推荐值开始调整 / More threads ≠ better performance! Start with recommended values.
